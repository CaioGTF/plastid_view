# plastid_view

`plastid_view` is an R script designed to visualize the **percentage of plastid content per metagenomic bin** using the output generated by **plastid_stats.py**.

This tool provides a clear and intuitive graphical representation of bins enriched with plastid-derived sequences, supporting downstream taxonomic and functional analyses.

---

## Input

The script requires as input **the CSV file generated by `plastid_stats.py`**.
This file must contain at least the following columns:

* `bin_id` â€” identifier of the metagenomic bin
* `plastid_nt_percent` â€” percentage of plastid-derived nucleotides in each bin

Example input file:

```
bin_id,plastid_nt_percent
bin.1,12.4
bin.2,35.7
bin.3,8.1
```

Update the file path in the script accordingly:

```r
FILE_PATH <- "plastid_bin_stats.csv"
```

---

## Requirements

The following R packages are required:

* `ggplot2`
* `dplyr`

Install them if necessary:

```r
install.packages(c("ggplot2", "dplyr"))
```

---

## Script

```r
library(ggplot2)
library(dplyr)

FILE_PATH <- "plastid_bin_stats.csv"

# Load plastid_stats output
df <- read.csv(FILE_PATH, header = TRUE)

# Filter bins with >10% plastid content
df_filtrado <- df %>%
  filter(plastid_nt_percent > 10)

# Plot plastid content per bin
ggplot(df_filtrado, aes(x = reorder(bin_id, plastid_nt_percent),
                        y = plastid_nt_percent)) +
  geom_col(fill = "#2C7FB8") +
  geom_text(aes(label = paste0(round(plastid_nt_percent, 1), "%")),
            hjust = -0.1,
            size = 3.5) +
  coord_flip() +
  labs(
    title = "Bins with high plastid content",
    subtitle = "Bins with more than 10% plastid-derived nucleotides",
    x = "Bins",
    y = "Plastid content (%)"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold"),
    axis.text.y = element_text(size = 10)
  )
```

---

## Output

The output is a horizontal bar plot showing:

* metagenomic bins with **>10% plastid content**;
* bins ordered by plastid nucleotide percentage;
* percentage values annotated directly on the bars.

This visualization facilitates the identification of **candidate plastid bins** for further taxonomic and functional analyses.

---

## ğŸ§¬ Integration

`plastid_view` is designed to work seamlessly with:

* **plastid_stats.py** â€” plastid content quantification
* **CAT / CAT_pack** â€” taxonomic classification
* **eggNOG-mapper** â€” functional annotation

---

## âœï¸ Authors

Developed by **Caio Gabriel Tavares Ferreira**
In collaboration with **Dr. Raul Maia FalcÃ£o**

---

## ğŸ“œ License

This project is released under the MIT License.
